import os
import pandas as pd
from os.path import join as pjoin
root = '/home/user/projects/GAN_project/cluster_lists'
with open(root + "/sample_sizes_kb.txt", "a") as myfile:
    myfile.write('fname|size \n')
mal_data_dir = '/home/user/projects/dataset/Malimg_exe_test/'
for sample_name in os.listdir(mal_data_dir):
    size = os.path.getsize(pjoin(mal_data_dir,sample_name))
    with open(root + "/sample_sizes_kb.txt", "a") as myfile:
        myfile.write(sample_name + '|' + str(round(size/1024))+'\n')

column_subset = [ 'fname', 'size' ]    
df = pd.read_csv(root + '/sample_sizes_kb.txt',sep=r'\|', usecols=column_subset)

df = df.sort_values(by=['size'])
df.to_csv(path_or_buf = root + "/sample_sizes_sorted_kb.txt", sep='|')

column_subset = [ 'fname', 'size' ]    
df = pd.read_csv(root + '/sample_sizes_sorted_kb.txt',sep=r'\|', usecols=column_subset)
cluster = df[(df["size"] >1) & (df["size"] <=50)]
cluster.to_csv(path_or_buf = root + "/clusters/cluster_1.txt", sep='|')
cluster = df[(df["size"] >50) & (df["size"] <=100)]
cluster.to_csv(path_or_buf = root + "/clusters/cluster_2.txt", sep='|')
cluster = df[(df["size"] >100) & (df["size"] <=200)]
cluster.to_csv(path_or_buf = root + "/clusters/cluster_3.txt", sep='|')
cluster = df[(df["size"] >200) & (df["size"] <=300)]
cluster.to_csv(path_or_buf = root + "/clusters/cluster_4.txt", sep='|')
cluster = df[(df["size"] >300) & (df["size"] <=400)]
cluster.to_csv(path_or_buf = root + "/clusters/cluster_5.txt", sep='|')
cluster = df[(df["size"] >400) & (df["size"] <=500)]
cluster.to_csv(path_or_buf = root + "/clusters/cluster_6.txt", sep='|')
cluster = df[(df["size"] >500)]
cluster.to_csv(path_or_buf = root + "/clusters/cluster_7.txt", sep='|')

