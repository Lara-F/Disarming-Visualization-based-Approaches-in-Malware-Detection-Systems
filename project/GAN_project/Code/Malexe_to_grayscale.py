from Blackbox import MalwareDetectionModels
from DataUploader import UploadData
import os
import ImageProcessing
import random
import numpy as np
import math

exe_dir = '/home/user/projects/dataset/Malimg_exe_train/'
img_dir = '/home/user/projects/dataset/train_images_with_colormap/GRAY/m_greyscale/mm_greyscale/'
ds_dir = '/home/user/projects/dataset/train_images_with_colormap/GRAY/m_greyscale/'
colormap = np.load('/home/user/projects/dataset/colormap/gray_colormap.npy')

width = 512
exe_names = os.listdir(exe_dir)
random.shuffle(exe_names)
i=0
for name in exe_names:
    or_dir = exe_dir+name 
    img_bin_array = ImageProcessing.readBytes(or_dir)
    grayscale_array = ImageProcessing.to1DArray_grayscale(img_bin_array,colormap)
    height = math.ceil(len(grayscale_array)/width)
    if i<=9:
        ImageProcessing.saveImg(img_dir+'000'+str(i)+'.png', grayscale_array, (width,height),'L')
    elif i>=10 and i<100:
        ImageProcessing.saveImg(img_dir+'00'+str(i)+'.png', grayscale_array, (width,height),'L')
    elif i>=100 and i<1000:
        ImageProcessing.saveImg(img_dir+'0'+str(i)+'.png', grayscale_array, (width,height),'L')
    else:
        ImageProcessing.saveImg(img_dir+str(i)+'.png', grayscale_array, (width,height),'L')
    i=i+1