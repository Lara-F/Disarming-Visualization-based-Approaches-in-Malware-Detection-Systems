from Blackbox import MalwareDetectionModels
from DataUploader import UploadData
import ImageProcessing
import numpy as np
import os
import tensorflow.keras as keras
from tensorflow.keras import layers
import tensorflow as tf

uploader = UploadData()
mal_train, mal_val = uploader.upload_train_mal_set()
mal_test = uploader.upload_test_mal_set()
ben_test = uploader.upload_test_ben_set()

mixed_test = uploader.upload_test_set(ben_test,mal_test)

ben_train, ben_val = uploader.upload_train_ben_set()
mixed_train, mixed_val = uploader.upload_training_set(ben_train, ben_val,mal_train, mal_val)
bb_detector = MalwareDetectionModels(256, 256, 'M11',mixed_train, mixed_val,mixed_test,loaded=False)